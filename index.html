<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Omeglo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>

<style>
body{margin:0;background:#0e0f13;color:#fff;font-family:Arial}
header{background:#4f46e5;padding:12px;font-size:20px}
.hidden{display:none}
.center{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
.box{background:#12141c;padding:25px;border:1px solid #333;width:320px}
button,input{width:100%;margin-top:10px;padding:8px}
#chat{display:flex;height:calc(100vh - 50px)}
#left{width:300px;background:#000}
#right{flex:1;padding:10px}
#msgs{height:70%;background:#12141c;overflow:auto;padding:10px}
</style>
</head>

<body>
<header>Omeglo | Online: <span id="online">0</span></header>

<!-- 18+ -->
<div class="center" id="age">
  <div class="box">
    <h3>18+ Warning</h3>
    <button onclick="goMode()">I Agree</button>
  </div>
</div>

<!-- MODE -->
<div class="center hidden" id="mode">
  <div class="box">
    <input id="interest" placeholder="Interests (optional)">
    <button onclick="start('video')">Video Chat</button>
    <button onclick="start('text')">Text Chat</button>
  </div>
</div>

<!-- CHAT -->
<div id="chat" class="hidden">
  <div id="left"></div>
  <div id="right">
    <div id="status">Connectingâ€¦</div>
    <div id="msgs"></div>
    <input id="msg">
    <button onclick="send()">Send</button>
    <button onclick="next()">Next</button>
  </div>
</div>

<script>
const socket = io("https://omeglo-server.onrender.com"); // render url
const online=document.getElementById("online");

socket.on("online-count", n=>online.innerText=n);
socket.on("matched",()=>status.innerText="Connected");
socket.on("message",m=>add("Stranger: "+m));
socket.on("partner_left",()=>status.innerText="Left");

function goMode(){
  age.classList.add("hidden");
  mode.classList.remove("hidden");
}
function start(){
  mode.classList.add("hidden");
  chat.classList.remove("hidden");
  socket.emit("join");
}
function send(){
  if(!msg.value)return;
  socket.emit("message",msg.value);
  add("You: "+msg.value);
  msg.value="";
}
function next(){
  msgs.innerHTML="";
  socket.emit("next");
}
function add(t){
  const d=document.createElement("div");
  d.innerText=t;
  msgs.appendChild(d);
}
</script>
</body>
</html>
